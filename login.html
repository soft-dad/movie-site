<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/login.css">
    <link rel="stylesheet" href="./css/index.css">
    <link rel="stylesheet" href="./css/common.css">
    <title>ç™»å½•</title>
</head>

<body>
<!-- èƒŒæ™¯éŸ³ä¹æ’­æ”¾å™¨ -->
<audio id="backgroundMusic" loop>
  <source src="./music/background_music.mp3" type="audio/mpeg">
  æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
</audio>

<!-- ç‚¹å‡»éŸ³æ•ˆæ’­æ”¾å™¨ï¼ˆæå‰åŠ è½½ï¼Œç¡®ä¿æ— å»¶è¿Ÿï¼‰ -->
<audio id="clickSound" preload="auto">
  <source src="./music/click.mp3" type="audio/mpeg">
  æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
</audio>

<!-- éŸ³ä¹æ§åˆ¶æŒ‰é’® -->
<button id="musicToggle" style="
    position: fixed; top: 100px; right: 20px; z-index: 1000;
    padding: 10px; cursor: pointer; background-color: rgba(0,0,0,0.5);
    color: white; border: none; border-radius: 5px;
">
  ğŸ”Š æ’­æ”¾éŸ³ä¹
</button>

<script>
  // 1. é›†ä¸­è·å–æ‰€æœ‰æ ¸å¿ƒå…ƒç´ 
  const music = document.getElementById('backgroundMusic');
  const toggleButton = document.getElementById('musicToggle');
  const clickSound = document.getElementById('clickSound');

  // 2. èƒŒæ™¯éŸ³ä¹çŠ¶æ€æ£€æŸ¥å‡½æ•°
  function checkMusicStatus() {
    const isPlaying = localStorage.getItem('musicPlaying') === 'true';
    if (isPlaying) {
      music.play().then(() => {
        toggleButton.textContent = 'ğŸ”‡ å…³é—­éŸ³ä¹';
      }).catch(error => {
        console.log("é¡µé¢åˆ‡æ¢æ—¶è‡ªåŠ¨æ’­æ”¾å¤±è´¥ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’:", error);
        localStorage.setItem('musicPlaying', 'false');
        toggleButton.textContent = 'ğŸ”Š æ’­æ”¾éŸ³ä¹';
      });
    } else {
      toggleButton.textContent = 'ğŸ”Š æ’­æ”¾éŸ³ä¹';
    }
  }

  // 3. èƒŒæ™¯éŸ³ä¹æ§åˆ¶å‡½æ•°
  function toggleMusic() {
    if (music.paused) {
      music.play().then(() => {
        toggleButton.textContent = 'ğŸ”‡ å…³é—­éŸ³ä¹';
        localStorage.setItem('musicPlaying', 'true');
      }).catch(error => {
        console.log("éŸ³ä¹æ’­æ”¾å¤±è´¥ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’:", error);
        toggleButton.textContent = 'ğŸ”Š è¯·ç‚¹å‡»æˆ‘æ’­æ”¾éŸ³ä¹';
      });
    } else {
      music.pause();
      toggleButton.textContent = 'ğŸ”Š æ’­æ”¾éŸ³ä¹';
      localStorage.setItem('musicPlaying', 'false');
    }
  }

  // 4. ç‚¹å‡»éŸ³æ•ˆæ’­æ”¾å‡½æ•°ï¼ˆå¢åŠ é”™è¯¯æ•è·ï¼Œç¡®ä¿ç¨³å®šï¼‰
  function playClickSound() {
    try {
      // æ¯æ¬¡æ’­æ”¾å‰é‡ç½®éŸ³é¢‘ä½ç½®ï¼Œé¿å…è¿ç»­ç‚¹å‡»éŸ³æ•ˆå åŠ 
      clickSound.currentTime = 0;
      // æ’­æ”¾éŸ³æ•ˆï¼Œæ•è·æµè§ˆå™¨ç­–ç•¥é™åˆ¶é”™è¯¯
      clickSound.play().catch(error => {
        if (error.name === 'NotAllowedError') {
          console.log("é¦–æ¬¡ç‚¹å‡»éœ€å…ˆæ¿€æ´»é¡µé¢ï¼ˆæµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾ç­–ç•¥é™åˆ¶ï¼‰ï¼Œå†æ¬¡ç‚¹å‡»å³å¯æ­£å¸¸æ’­æ”¾");
        } else {
          console.log("ç‚¹å‡»éŸ³æ•ˆæ’­æ”¾å¼‚å¸¸:", error);
        }
      });
    } catch (e) {
      console.log("éŸ³æ•ˆæ–‡ä»¶åŠ è½½å¼‚å¸¸:", e);
    }
  }

  // 5. å…¨å±€ç»‘å®šç‚¹å‡»éŸ³æ•ˆï¼ˆè¦†ç›–æ‰€æœ‰å…ƒç´ ï¼ŒåŒ…æ‹¬åŠ¨æ€å…ƒç´ ï¼‰
  function initGlobalClickSound() {
    // æ–¹å¼1ï¼šç»™documentç»‘å®šmousedownäº‹ä»¶ï¼ˆåº•å±‚äº‹ä»¶ï¼Œä¸è¢«å…ƒç´ æ‹¦æˆªï¼‰
    document.addEventListener('mousedown', playClickSound, { capture: true });

    // æ–¹å¼2ï¼šç›‘å¬åŠ¨æ€æ·»åŠ çš„å…ƒç´ ï¼ˆé˜²æ­¢åˆ†é¡µåŠ è½½ç­‰åœºæ™¯é—æ¼ï¼‰
    const observer = new MutationObserver(mutations => {
      mutations.forEach(mutation => {
        mutation.addedNodes.forEach(node => {
          // ä»…å¯¹HTMLå…ƒç´ èŠ‚ç‚¹ç»‘å®šäº‹ä»¶
          if (node.nodeType === 1) {
            node.addEventListener('mousedown', playClickSound, { capture: true });
          }
        });
      });
    });
    // ç›‘å¬bodyä¸‹æ‰€æœ‰å…ƒç´ å˜åŒ–ï¼ˆåŒ…æ‹¬å­æ ‘ï¼‰
    observer.observe(document.body, { childList: true, subtree: true });
  }

  // 6. é¡µé¢åŠ è½½å®Œæˆåç»Ÿä¸€åˆå§‹åŒ–ï¼ˆé¿å…é‡å¤ç»‘å®šï¼‰
  document.addEventListener('DOMContentLoaded', function() {
    checkMusicStatus();          // åˆå§‹åŒ–èƒŒæ™¯éŸ³ä¹
    toggleButton.addEventListener('click', toggleMusic); // ç»‘å®šéŸ³ä¹æ§åˆ¶æŒ‰é’®
    initGlobalClickSound();      // åˆå§‹åŒ–å…¨å±€ç‚¹å‡»éŸ³æ•ˆ
  });
</script>
<!-- å¤´éƒ¨å¯¼èˆª -->
<nav class="header">
    <div class="contain">
        <!-- logoåŒº -->
        <a href="#" class="logo"></a>
        <!-- åˆ—è¡¨ -->
        <ul>
            <li><a href="#" id="homeLink">é¦–é¡µ</a></li>
            <!-- ä¿®æ”¹ç”µå½±ä¸‹æ‹‰èœå•ç»“æ„ï¼Œå¢åŠ ä¸“ç”¨ç±»å -->
            <li class="dropdown movie-dropdown">
                <a href="./movie.html" class="dropbtn">ç”µå½±</a>
                <div class="dropdown-content">
                    <a href="./category_Action.html">åŠ¨ä½œç‰‡</a>
                    <a href="./category_Comedy.html">å–œå‰§ç‰‡</a>
                    <a href="./category_Romance.html">çˆ±æƒ…ç‰‡</a>
                    <a href="./category_Sci-fic.html">ç§‘å¹»ç‰‡</a>
                </div>
            </li>
            <li><a href="./cinema.html">å½±é™¢</a></li> <!-- ä¿®æ­£"æ¼”é™¢"ä¸º"å½±é™¢" -->
            <li class="dropdown">
                <a href="./liuyan.html" class="dropbtn">åé¦ˆ</a>
                <div class="dropdown-content">
                    <a href="liuyan_tel.html">ç”µè¯å®¢æœ</a>
                    <a href="liuyan.html">ç³»ç»Ÿç•™è¨€</a>
                    <a href="liuyan_feedback.html">æ„è§åé¦ˆ</a>
                    <a href="liuyan_about.html">å…³äºæˆ‘ä»¬</a>
                </div>
            </li>
            <li><a href="./mall.html">å•†åŸ</a></li>
        </ul>
        <!-- ç”¨æˆ·ç™»å…¥ -->
        <div class="userinfo">
            <img src="./img/userifo.png" alt="ç”¨æˆ·">
            <a href="./login.html" style="margin-left: 20px;">ç™»å½•</a>
        </div>
        <!-- æœç´¢åŒº -->
        <form action="#" class="serch-form" method="POST">
            <input type="search" class="search" placeholder="æ‰¾å½±è§†å‰§ å½±äºº å½±é™¢">
            <input type="button" class="submit" value="">
        </form>
        <!-- appä¸‹è½½ -->
        <div class="appdownload">
            <a href="#">
                <span class="iphone-icon"></span>
                <span class="apptext">appä¸‹è½½</span>
                <span class="caret"></span>
                <div class="downloadicon">
                    <p class="down-title">æ‰«ç ä¸‹è½½app</p>
                    <p class="down-content">é€‰åº§æ›´ä¼˜æƒ </p>
                </div>
            </a>
        </div>
    </div>
</nav>

<br>
<br>
<br>
<br>
    <!-- ç™»å½•çš„logoåŒºåŸŸ -->
    <div class="site-logo"></div>
    <!-- ç™»å½•çš„ä¸»ä½“åŒºåŸŸ -->
    <div class="login-body clearfix">
        <div class="login-img fl">
            <img src="./img/loginimg.png" alt="ç”µå½±">
        </div>
        <div class="login-form fr">
            <form action="#" method="POST" class="form-stack" id="loginForm">
                <p>
                    è´¦å·ç™»å½•<span class="fr">æ‰‹æœºåŠ¨æ€ç ç™»å½•</span>
                </p>
                <div class="phone-input-wrapper">
                    <span class="country-area">
                        <span class="plus">+</span>
                        <span>86&nbsp;&gt;</span>
                    </span>
                    <input type="text" name="email" id="login-email" placeholder="æ‰‹æœºå·" maxlength="15">
                </div>
                <div class="phone-input-password">
                    <i class="icon-passwword"></i>
                    <input type="password" name="password" id="login-password" placeholder="å¯†ç " maxlength="15"
                        oninput="checkPasswordStrength()">
                    <span id="password-strength" class="password-strength"></span> <!-- æ·»åŠ çš„å¯†ç å¼ºåº¦æç¤ºå…ƒç´  -->
                </div>
                <div class="forgetpassword">
                    <a href="#">å¿˜è®°å¯†ç ?</a>
                </div>
                <input type="submit" class="loginin" value="ç™»å½•">
                <p class="signup-guide">
                    è¿˜æ²¡æœ‰è´¦å·?
                    <a href="#">ç‚¹å‡»æ³¨å†Œ</a>
                </p>
            </form>
        </div>
    </div>
    <script src="./js/login.js" type="text/javascript"></script>
</body>

</html>